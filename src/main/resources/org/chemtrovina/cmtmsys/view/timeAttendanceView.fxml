<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>

<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.control.ScrollPane?>
<BorderPane prefHeight="650.0" prefWidth="1200.0"
            stylesheets="@../css/timeLog.css"
            xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.chemtrovina.cmtmsys.controller.TimeAttendanceController">

    <top>
        <VBox spacing="10.0">
            <padding>
                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
            </padding>

            <HBox alignment="CENTER_LEFT" spacing="10.0">
                <children>
                    <Label text="Lọc theo ngày:" style="-fx-font-weight: bold;" />
                    <Label text="Ngày:" />
                    <DatePicker fx:id="dpScanDate" promptText="YYYY-MM-DD" />
                    <Button fx:id="btnFilterDate" text="Lọc" />
                    <Button fx:id="btnClearDateFilter" text="Xóa lọc" />
                </children>
            </HBox>

            <HBox alignment="CENTER_LEFT" spacing="10.0">
                <children>
                    <Label text="Scan Điểm Danh:" style="-fx-font-weight: bold;" />

                    <TextField fx:id="txtScanInput"
                               prefWidth="200.0"
                               promptText="Nhập Mã thẻ / Mã NV và Enter" />
                    <Button fx:id="btnScan" text="SCAN" />
                    <HBox spacing="20">
                        <Button fx:id="btnIn" text="IN"
                                style="-fx-font-size: 18px; -fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold;" />

                        <Button fx:id="btnOut" text="OUT"
                                style="-fx-font-size: 18px; -fx-background-color: #9E9E9E; -fx-text-fill: white; -fx-font-weight: bold;" />

                        <Label fx:id="lblScanType"
                               text="TYPE: NONE"
                               style="-fx-font-size: 22px; -fx-font-weight: bold;" />
                    </HBox>


                    <Label fx:id="lblScanStatus" text="Sẵn sàng" style="-fx-text-fill: green; -fx-font-weight: bold;" />
                </children>
            </HBox>

            <TitledPane text="Import chấm công từ Excel"
                        expanded="true">
                <content>
                    <HBox spacing="15"
                          alignment="CENTER_LEFT"
                          >

                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>

                        <!-- Ngày import -->
                        <Label text="Ngày import:" style="-fx-font-weight: bold;" />
                        <DatePicker fx:id="dpImportDate"
                                    promptText="YYYY-MM-DD"
                                    prefWidth="150"/>

                        <!-- Chọn file -->
                        <Button fx:id="btnChooseExcel"
                                text="Chọn file Excel"/>

                        <Label fx:id="lblExcelFile"
                               text="Chưa chọn file"
                               style="-fx-text-fill: gray; -fx-font-style: italic;"/>

                        <!-- Import -->
                        <Button fx:id="btnImportExcel"
                                text="IMPORT"
                                disable="true"
                                style="-fx-background-color: #1976D2;
                           -fx-text-fill: white;
                           -fx-font-weight: bold;"/>

                        <!-- Status -->
                        <Label fx:id="lblImportStatus"
                               text=""
                               style="-fx-font-weight: bold;"/>

                    </HBox>
                </content>
            </TitledPane>

        </VBox>
    </top>

    <center>
        <VBox spacing="10.0">
            <padding>
                <Insets top="10" right="10" bottom="10" left="10"/>
            </padding>
            <!-- PANE 1: BẢNG ĐIỂM DANH -->
            <TitledPane text="Danh sách điểm danh" expanded="true" VBox.vgrow="ALWAYS">
                <content>
                    <ScrollPane
                            fitToHeight="true"
                            fitToWidth="true"
                            pannable="true"
                            hbarPolicy="AS_NEEDED"
                            vbarPolicy="AS_NEEDED">

                        <TableView fx:id="tblTimeAttendanceLog"
                                   VBox.vgrow="ALWAYS">
                            <columns>

                                <TableColumn text="No">
                                    <columns>
                                        <TableColumn fx:id="colNo" prefWidth="40.0" text="STT" />
                                    </columns>
                                </TableColumn>

                                <TableColumn fx:id="colInput"
                                             id="colVang"
                                             styleClass="header-yellow"
                                             text="CỘT NHẬP" />

                                <TableColumn text="Full Name">
                                    <columns>
                                        <TableColumn fx:id="colFullName"
                                                     prefWidth="150.0"
                                                     text="HỌ VÀ TÊN" />
                                    </columns>
                                </TableColumn>

                                <TableColumn fx:id="colCompany" text="Công Ty" />
                                <TableColumn fx:id="colDepartment" text="Bộ phận" />
                                <TableColumn fx:id="colGender" text="Giới tính" />
                                <TableColumn fx:id="colPosition" text="Chức vụ" />

                                <TableColumn fx:id="colNote"
                                             prefWidth="250.0"
                                             id="colVang"
                                             styleClass="header-yellow"
                                             text="LÝ DO VẮNG/TRỄ/CẮT TÊN" />

                                <TableColumn fx:id="colJobTitle" text="Công việc" />
                                <TableColumn fx:id="colManager"
                                             id="colVang"
                                             styleClass="header-yellow"
                                             text="Quản lý" />

                                <TableColumn fx:id="colDateOfBirth" text="Ngày sinh" />
                                <TableColumn fx:id="colEntryDate" text="Ngày vào" />
                                <TableColumn fx:id="colShift" text="Ca chuyển đổi" />
                                <TableColumn fx:id="colPhoneNumber" text="Số điện thoại" />

                                <TableColumn fx:id="colY" prefWidth="30.0" text="Ca" />
                                <TableColumn fx:id="colIn"  id="colVang" styleClass="header-yellow" text="IN" />
                                <TableColumn fx:id="colOut" id="colVang" styleClass="header-yellow" text="OUT" />

                            </columns>
                        </TableView>

                    </ScrollPane>
                </content>
            </TitledPane>

            <!-- PANE 2: SUMMARY (DÙNG SAU) -->
            <TitledPane text="Tổng hợp / Thống kê" expanded="true">
                <content>
                    <HBox spacing="25" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>

                        <Label text="Tổng nhân sự:"/>
                        <Label fx:id="lblTotalEmployee"
                               text="0"
                               style="-fx-font-weight: bold"/>

                        <Label text="Đã đi làm:"/>
                        <Label fx:id="lblTotalIn"
                               text="0"
                               style="-fx-font-weight: bold; -fx-text-fill: green"/>

                        <Label text="Không đi làm:"/>
                        <!-- CLICKABLE -->
                        <Label fx:id="lblAbsentCount"
                               text="0"
                               style="-fx-font-weight: bold;
                          -fx-text-fill: red;
                          -fx-underline: true;
                          -fx-cursor: hand"/>
                    </HBox>
                </content>
            </TitledPane>

            <TitledPane fx:id="tpAbsentList"
                        text="Danh sách không đi làm"
                        expanded="false">

                <content>
                    <VBox spacing="10">
                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>

                        <TableView fx:id="tblAbsentEmployees"
                                   editable="true"
                                   prefHeight="300">

                            <columns>
                                <TableColumn fx:id="colAbsentNo" text="No" />
                                <TableColumn fx:id="colAbsentCode" text="Code" />
                                <TableColumn fx:id="colAbsentName" text="Name" />
                                <TableColumn fx:id="colAbsentDept" text="Department" />
                                <TableColumn fx:id="colAbsentShift" text="Shift" />
                                <TableColumn fx:id="colAbsentNote" text="Note" />
                            </columns>
                        </TableView>
                    </VBox>
                </content>
            </TitledPane>

        </VBox>
    </center>

</BorderPane>