<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<AnchorPane prefHeight="700.0" prefWidth="900.0"
            xmlns="http://javafx.com/javafx/23.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.chemtrovina.cmtmsys.controller.FeederMultiRollController">

    <VBox spacing="10" AnchorPane.topAnchor="10" AnchorPane.leftAnchor="10" AnchorPane.rightAnchor="10" AnchorPane.bottomAnchor="10">

        <!-- Tiêu đề -->
        <Label text="Quản lý Gắn Cuộn cho Feeder" style="-fx-font-size: 18px; -fx-font-weight: bold;" />

        <!-- Chọn model -->
        <HBox spacing="10">
            <TextField fx:id="txtModelCode" promptText="Mã Model" prefWidth="120" />
            <ComboBox fx:id="cbModelType" promptText="Loại Model" prefWidth="120" />
            <ComboBox fx:id="cbLines" promptText="Chọn Line" prefWidth="180" />
            <Button fx:id="btnLoadFeeders" text="Tải Feeders" />
        </HBox>

        <!-- Phiên chạy -->
        <HBox spacing="10">
            <Label text="Phiên chạy:" />
            <ComboBox fx:id="cbRunHistory" promptText="Chọn phiên" prefWidth="150" />
            <Button fx:id="btnCreateRun" text="Tạo phiên mới" />
            <Button fx:id="btnToggleRun" text="ON/OFF" />


        </HBox>

        <!-- Bảng feeder -->
        <TableView fx:id="tblFeederAssignments" prefHeight="380.0">
            <columns>
                <TableColumn fx:id="colFeederCode" text="Feeder Code" prefWidth="100" />
                <TableColumn fx:id="colMachine" text="Machine" prefWidth="100" />
                <TableColumn fx:id="colSapCode" text="SAP Code" prefWidth="100" />
                <TableColumn fx:id="colFeederQty" text="Feeder Qty" prefWidth="80" />
                <TableColumn fx:id="colRollCode" text="Cuộn đang gắn" prefWidth="140" />
                <TableColumn fx:id="colMaterialQty" text="SL Cuộn" prefWidth="80" />
                <TableColumn fx:id="colStatus" text="Trạng thái" prefWidth="120" />
            </columns>
        </TableView>

        <!-- Chia đôi phần dưới -->
        <HBox spacing="20" HBox.hgrow="ALWAYS">
            <!-- Bên trái: Gắn/cuộn tìm feeder -->
            <VBox spacing="10" HBox.hgrow="ALWAYS">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Scan FeederCode:" />
                    <TextField fx:id="txtSearchFeederCode" promptText="Quét mã Feeder..." prefWidth="200" />
                </HBox>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Scan RollCode để GẮN:" />
                    <TextField fx:id="txtRollCode" promptText="Quét mã cuộn để gắn vào feeder" prefWidth="200" />
                </HBox>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Scan RollCode để tìm Feeder theo SAP:" />
                    <TextField fx:id="txtScanRollForSap" promptText="Quét mã cuộn..." prefWidth="200" />
                </HBox>

                <TableView fx:id="tblFeederBySap" prefHeight="250" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colFeederCodeBySap" text="Feeder Code" prefWidth="100" />
                        <TableColumn fx:id="colSapCodeBySap" text="SAP Code" prefWidth="100" />
                        <TableColumn fx:id="colStatusBySap" text="Trạng thái" prefWidth="100" />
                        <TableColumn fx:id="colAttachButton" text="Gắn" prefWidth="60" />
                        <TableColumn fx:id="colDeleteButton" text="Xóa" prefWidth="60" />
                    </columns>
                </TableView>
            </VBox>

            <!-- Bên phải: Tìm cuộn theo Xe/Cây -->
            <VBox spacing="10" HBox.hgrow="ALWAYS" prefHeight="370"> <!-- 👈 Giới hạn chiều cao -->
                <TitledPane text="📦 Tìm cuộn theo Xe / Cây" expanded="true">
                    <VBox spacing="10">

                        <HBox spacing="5">
                            <Label text="Xe cây:" />
                            <ComboBox fx:id="cbTruckCode" prefWidth="100" promptText="Chọn mã xe..." />
                            <Label text="Mã cây:" />
                            <TextField fx:id="txtTreeCode" promptText="Nhập mã cây..." prefWidth="100" />
                            <Label text="Mã cuộn:" />
                            <TextField fx:id="txtRollCodeSearch" promptText="Nhập mã cuộn..." prefWidth="100" />
                            <Label text="SAP Code:" />
                            <TextField fx:id="txtSapSearch" promptText="SAP..." prefWidth="80" />
                            <Button fx:id="btnSearchTree" text="🔍" />
                        </HBox>

                        <TitledPane text="📄 Danh sách Cây trong Xe đã chọn" expanded="true">
                            <TableView fx:id="tblTreeList" prefHeight="120">
                                <columns>
                                    <TableColumn fx:id="colTreeCode" text="Mã Cây" />
                                    <TableColumn fx:id="colCreatedDate" text="Ngày tạo" />
                                    <TableColumn fx:id="colFloor" text="Tầng" />
                                </columns>
                            </TableView>
                        </TitledPane>

                        <TitledPane text="📦 Danh sách Cuộn trong Cây đã chọn" expanded="true">
                            <TableView fx:id="tblRollInTree" prefHeight="120">
                                <columns>
                                    <TableColumn fx:id="colRollCodeInTree" text="Mã Cuộn" />
                                    <TableColumn fx:id="colSapCodeInTree" text="SAP Code" />
                                    <TableColumn fx:id="colQtyInTree" text="Số lượng" />
                                    <TableColumn fx:id="colWarehouseInTree" text="Kho" />
                                </columns>
                            </TableView>
                        </TitledPane>

                    </VBox>
                </TitledPane>
            </VBox>
        </HBox>



        <!-- Log -->
        <TextArea fx:id="txtStatusLog" editable="false" prefHeight="80" wrapText="true" />

    </VBox>
</AnchorPane>
